#! /bin/sh

# a togglable scratchpad
# Once ran, it will move the focused window into the scratchpad.
# Running it again brings back the window.
# Killing the window will free the scratchpad so a new window can be added!

# Todo: 

# Cache the pid of the current window on the scratchpad
cache_file="$HOME/.cache/scratchpad"

cat ${cache_file}
# If file doesn't exist, then make one
if [ $? -ne 0 ]; then
	echo `xdotool getactivewindow` > ${cache_file}
fi

id=`cat ${cache_file} | head -1`

# Toggle hide, set it to be on top of all windows, on the focused monitor.
bspc node "${id}" --flag hidden --flag sticky=on --to-monitor focused

# Check if the previous command worked properly
if [ $? -eq 0 ]; then
	# If yes, focus on it regardless of being hidden (makes code simpler)
	bspc node "${id}" --focus
	# Set it t
	bspc node "${id}" -t floating
else
	# If it failed due to invalid pid, means that the window was exited
	# Delete the cache file and move the current focused window into scratchpad
	rm ${cache_file}
	scratchpad-modified
fi